<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title># Lorenz 96 · NPSMC.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NPSMC.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">NPSMC.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../catalog/">Catalog</a></li><li><a class="tocitem" href="../../data_assimilation/">Data Assimilation</a></li><li><a class="tocitem" href="../../state-space/">State Space</a></li><li><a class="tocitem" href="../../models/">Models</a></li><li><a class="tocitem" href="../../ensemble_kalman_filters/">Ensemble Kalman filters</a></li><li><a class="tocitem" href="../../ensemble_kalman_smoothers/">Ensemble Kalman smoothers</a></li><li><a class="tocitem" href="../../forecasting/">Forecasting</a></li><li><a class="tocitem" href="../../particle_filters/">Particle filters</a></li><li><a class="tocitem" href="../../time-series/">Time Series</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href># Lorenz 96</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href># Lorenz 96</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/npsmc/NPSMC.jl/blob/master/docs/src/examples/lorenz96.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="#-Lorenz-96-1"><a class="docs-heading-anchor" href="##-Lorenz-96-1"># Lorenz 96</a><a class="docs-heading-anchor-permalink" href="##-Lorenz-96-1" title="Permalink"></a></h1><h1 id="-1"><a class="docs-heading-anchor" href="#-1"></a><a class="docs-heading-anchor-permalink" href="#-1" title="Permalink"></a></h1><h1 id="Data-assimilation-are-numerical-methods-used-in-geosciences-to-mix-the-information-of-observations-(noted-as-y)-and-a-dynamical-model-(noted-as-f)-in-order-to-estimate-the-true/hidden-state-of-the-system-(noted-as-x)-at-every-time-step-k.-Usually,-they-are-related-following-a-nonlinear-state-space-model:-1"><a class="docs-heading-anchor" href="#Data-assimilation-are-numerical-methods-used-in-geosciences-to-mix-the-information-of-observations-(noted-as-y)-and-a-dynamical-model-(noted-as-f)-in-order-to-estimate-the-true/hidden-state-of-the-system-(noted-as-x)-at-every-time-step-k.-Usually,-they-are-related-following-a-nonlinear-state-space-model:-1">Data assimilation are numerical methods used in geosciences to mix the information of observations (noted as <span>$y$</span>) and a dynamical model (noted as <span>$f$</span>) in order to estimate the true/hidden state of the system (noted as <span>$x$</span>) at every time step <span>$k$</span>. Usually, they are related following a nonlinear state-space model:</a><a class="docs-heading-anchor-permalink" href="#Data-assimilation-are-numerical-methods-used-in-geosciences-to-mix-the-information-of-observations-(noted-as-y)-and-a-dynamical-model-(noted-as-f)-in-order-to-estimate-the-true/hidden-state-of-the-system-(noted-as-x)-at-every-time-step-k.-Usually,-they-are-related-following-a-nonlinear-state-space-model:-1" title="Permalink"></a></h1><h1 id="img-srchttps://tandeo.files.wordpress.com/2019/02/formule*nnss*model.png-width&quot;200&quot;-1"><a class="docs-heading-anchor" href="#img-srchttps://tandeo.files.wordpress.com/2019/02/formule*nnss*model.png-width&quot;200&quot;-1">&lt;img src=https://tandeo.files.wordpress.com/2019/02/formule<em>nnss</em>model.png width=&quot;200&quot;&gt;</a><a class="docs-heading-anchor-permalink" href="#img-srchttps://tandeo.files.wordpress.com/2019/02/formule*nnss*model.png-width&quot;200&quot;-1" title="Permalink"></a></h1><h1 id="with-\\eta-and-\\epsilon-some-independant-white-Gaussian-noises-respectively-respresenting-the-model-forecast-error-and-the-error-of-observation.-1"><a class="docs-heading-anchor" href="#with-\\eta-and-\\epsilon-some-independant-white-Gaussian-noises-respectively-respresenting-the-model-forecast-error-and-the-error-of-observation.-1">with <span>$\eta$</span> and <span>$\epsilon$</span> some independant white Gaussian noises respectively respresenting the model forecast error and the error of observation.</a><a class="docs-heading-anchor-permalink" href="#with-\\eta-and-\\epsilon-some-independant-white-Gaussian-noises-respectively-respresenting-the-model-forecast-error-and-the-error-of-observation.-1" title="Permalink"></a></h1><h1 id="-2"><a class="docs-heading-anchor" href="#-2"></a><a class="docs-heading-anchor-permalink" href="#-2" title="Permalink"></a></h1><h1 id="In-classical-data-assimilation,-we-require-multiple-runs-of-an-explicit-dynamical-model-f-with-possible-severe-limitations-including-the-computational-cost,-the-lack-of-consistency-of-the-model-with-respect-to-the-observed-data-as-well-as-modeling-uncertainties.-Here,-an-alternative-strategy-is-explored-by-developing-a-fully-data-driven-assimilation.-No-explicit-knowledge-of-the-dynamical-model-is-required.-Only-a-representative-catalog-of-trajectories-of-the-system-is-assumed-to-be-available.-Based-on-this-catalog,-the-Analog-Data-Assimilation-(AnDA)-is-introduced-by-combining-machine-learning-with-the-analog-method-(or-nearest-neighbor-search)-and-stochastic-assimilation-techniques-including-Ensemble-Kalman-Filter-and-Smoother-(EnKF,-EnKS)-and-Particle-Filter-(PF).-We-test-the-accuracy-of-the-technic-on-chaotic-dynamical-models,-the-Lorenz-96-system.-1"><a class="docs-heading-anchor" href="#In-classical-data-assimilation,-we-require-multiple-runs-of-an-explicit-dynamical-model-f-with-possible-severe-limitations-including-the-computational-cost,-the-lack-of-consistency-of-the-model-with-respect-to-the-observed-data-as-well-as-modeling-uncertainties.-Here,-an-alternative-strategy-is-explored-by-developing-a-fully-data-driven-assimilation.-No-explicit-knowledge-of-the-dynamical-model-is-required.-Only-a-representative-catalog-of-trajectories-of-the-system-is-assumed-to-be-available.-Based-on-this-catalog,-the-Analog-Data-Assimilation-(AnDA)-is-introduced-by-combining-machine-learning-with-the-analog-method-(or-nearest-neighbor-search)-and-stochastic-assimilation-techniques-including-Ensemble-Kalman-Filter-and-Smoother-(EnKF,-EnKS)-and-Particle-Filter-(PF).-We-test-the-accuracy-of-the-technic-on-chaotic-dynamical-models,-the-Lorenz-96-system.-1">In classical data assimilation, we require multiple runs of an explicit dynamical model <span>$f$</span> with possible severe limitations including the computational cost, the lack of consistency of the model with respect to the observed data as well as modeling uncertainties. Here, an alternative strategy is explored by developing a fully data-driven assimilation. No explicit knowledge of the dynamical model is required. Only a representative catalog of trajectories of the system is assumed to be available. Based on this catalog, the Analog Data Assimilation (AnDA) is introduced by combining machine learning with the analog method (or nearest neighbor search) and stochastic assimilation techniques including Ensemble Kalman Filter and Smoother (EnKF, EnKS) and Particle Filter (PF). We test the accuracy of the technic on chaotic dynamical models, the Lorenz-96 system.</a><a class="docs-heading-anchor-permalink" href="#In-classical-data-assimilation,-we-require-multiple-runs-of-an-explicit-dynamical-model-f-with-possible-severe-limitations-including-the-computational-cost,-the-lack-of-consistency-of-the-model-with-respect-to-the-observed-data-as-well-as-modeling-uncertainties.-Here,-an-alternative-strategy-is-explored-by-developing-a-fully-data-driven-assimilation.-No-explicit-knowledge-of-the-dynamical-model-is-required.-Only-a-representative-catalog-of-trajectories-of-the-system-is-assumed-to-be-available.-Based-on-this-catalog,-the-Analog-Data-Assimilation-(AnDA)-is-introduced-by-combining-machine-learning-with-the-analog-method-(or-nearest-neighbor-search)-and-stochastic-assimilation-techniques-including-Ensemble-Kalman-Filter-and-Smoother-(EnKF,-EnKS)-and-Particle-Filter-(PF).-We-test-the-accuracy-of-the-technic-on-chaotic-dynamical-models,-the-Lorenz-96-system.-1" title="Permalink"></a></h1><h1 id="-3"><a class="docs-heading-anchor" href="#-3"></a><a class="docs-heading-anchor-permalink" href="#-3" title="Permalink"></a></h1><h1 id="This-Julia-program-is-dervied-from-the-Python-library-is-attached-to-the-following-publication:-1"><a class="docs-heading-anchor" href="#This-Julia-program-is-dervied-from-the-Python-library-is-attached-to-the-following-publication:-1">This Julia program is dervied from the Python library is attached to the following publication:</a><a class="docs-heading-anchor-permalink" href="#This-Julia-program-is-dervied-from-the-Python-library-is-attached-to-the-following-publication:-1" title="Permalink"></a></h1><h1 id="Lguensat,-R.,-Tandeo,-P.,-Ailliot,-P.,-Pulido,-M.,-and-Fablet,-R.-(2017).-The-Analog-Data-Assimilation.-*Monthly-Weather-Review*,-145(10),-4093-4107.-1"><a class="docs-heading-anchor" href="#Lguensat,-R.,-Tandeo,-P.,-Ailliot,-P.,-Pulido,-M.,-and-Fablet,-R.-(2017).-The-Analog-Data-Assimilation.-*Monthly-Weather-Review*,-145(10),-4093-4107.-1">Lguensat, R., Tandeo, P., Ailliot, P., Pulido, M., &amp; Fablet, R. (2017). The Analog Data Assimilation. <em>Monthly Weather Review</em>, 145(10), 4093-4107.</a><a class="docs-heading-anchor-permalink" href="#Lguensat,-R.,-Tandeo,-P.,-Ailliot,-P.,-Pulido,-M.,-and-Fablet,-R.-(2017).-The-Analog-Data-Assimilation.-*Monthly-Weather-Review*,-145(10),-4093-4107.-1" title="Permalink"></a></h1><h1 id="If-you-use-this-library,-please-do-not-forget-to-cite-this-work.-1"><a class="docs-heading-anchor" href="#If-you-use-this-library,-please-do-not-forget-to-cite-this-work.-1">If you use this library, please do not forget to cite this work.</a><a class="docs-heading-anchor-permalink" href="#If-you-use-this-library,-please-do-not-forget-to-cite-this-work.-1" title="Permalink"></a></h1><p>using Plots, NPSMC, DifferentialEquations, Random, LinearAlgebra</p><h1 id="#-TEST-ON-LORENZ-96-1"><a class="docs-heading-anchor" href="##-TEST-ON-LORENZ-96-1"># TEST ON LORENZ-96</a><a class="docs-heading-anchor-permalink" href="##-TEST-ON-LORENZ-96-1" title="Permalink"></a></h1><h1 id="-4"><a class="docs-heading-anchor" href="#-4"></a><a class="docs-heading-anchor-permalink" href="#-4" title="Permalink"></a></h1><h1 id="We-also-test-the-analog-data-assimilation-procedure-on-the-40-dimensional-Lorenz-96-dynamical-model.-As-in-the-previous-experiment,-we-generate-state-and-observation-data-as-well-as-simulated-trajectories-of-the-Lorenz-96-model-in-order-to-emulate-the-dynamical-model.-Here,-we-compare-two-analog-data-assimilation-strategies:-the-global-and-local-analog-forecasting,-respectively-defined-in-finding-similar-situations-on-the-whole-40-variables-or-on-5-variables-recursively.-1"><a class="docs-heading-anchor" href="#We-also-test-the-analog-data-assimilation-procedure-on-the-40-dimensional-Lorenz-96-dynamical-model.-As-in-the-previous-experiment,-we-generate-state-and-observation-data-as-well-as-simulated-trajectories-of-the-Lorenz-96-model-in-order-to-emulate-the-dynamical-model.-Here,-we-compare-two-analog-data-assimilation-strategies:-the-global-and-local-analog-forecasting,-respectively-defined-in-finding-similar-situations-on-the-whole-40-variables-or-on-5-variables-recursively.-1">We also test the analog data assimilation procedure on the 40-dimensional Lorenz-96 dynamical model. As in the previous experiment, we generate state and observation data as well as simulated trajectories of the Lorenz-96 model in order to emulate the dynamical model. Here, we compare two analog data assimilation strategies: the global and local analog forecasting, respectively defined in finding similar situations on the whole 40 variables or on 5 variables recursively.</a><a class="docs-heading-anchor-permalink" href="#We-also-test-the-analog-data-assimilation-procedure-on-the-40-dimensional-Lorenz-96-dynamical-model.-As-in-the-previous-experiment,-we-generate-state-and-observation-data-as-well-as-simulated-trajectories-of-the-Lorenz-96-model-in-order-to-emulate-the-dynamical-model.-Here,-we-compare-two-analog-data-assimilation-strategies:-the-global-and-local-analog-forecasting,-respectively-defined-in-finding-similar-situations-on-the-whole-40-variables-or-on-5-variables-recursively.-1" title="Permalink"></a></h1><h1 id="-5"><a class="docs-heading-anchor" href="#-5">+</a><a class="docs-heading-anchor-permalink" href="#-5" title="Permalink"></a></h1><p>rng = MersenneTwister(123) F = 8 J = 40 :: Int64 parameters = [F, J] dt<em>integration = 0.05 # integration time dt</em>states = 1 # number of integration times between consecutive states (for xt and catalog) dt<em>obs = 4 # number of integration times between consecutive observations (for yo) var</em>obs = randperm(rng, J)[1:20] # indices of the observed variables nb<em>loop</em>train = 100 # size of the catalog nb<em>loop</em>test = 10 # size of the true state and noisy observations sigma2<em>catalog = 0.   # variance of the model error to generate the catalog    sigma2</em>obs = 2. # variance of the observation error to generate observations</p><p>ssm = StateSpaceModel( lorenz96,                         dt<em>integration, dt</em>states, dt<em>obs,                         parameters, var</em>obs,                        nb<em>loop</em>train, nb<em>loop</em>test,                        sigma2<em>catalog, sigma2</em>obs )</p><h1 id="-6"><a class="docs-heading-anchor" href="#-6">-</a><a class="docs-heading-anchor-permalink" href="#-6" title="Permalink"></a></h1><h1 id="time-steps-(to-be-in-the-attractor-space)-1"><a class="docs-heading-anchor" href="#time-steps-(to-be-in-the-attractor-space)-1">5 time steps (to be in the attractor space)</a><a class="docs-heading-anchor-permalink" href="#time-steps-(to-be-in-the-attractor-space)-1" title="Permalink"></a></h1><h1 id="-7"><a class="docs-heading-anchor" href="#-7">+</a><a class="docs-heading-anchor-permalink" href="#-7" title="Permalink"></a></h1><p>u0 = F .* ones(Float64, J) u0[J÷2] = u0[J÷2] + 0.01</p><p>tspan = (0.0,5.0) p = [F, J] prob  = ODEProblem(lorenz96, u0, tspan, p) sol = solve(prob, reltol=1e-6, saveat= dt_integration) x1  = [x[1] for x in sol.u] x20 = [x[20] for x in sol.u] x40 = [x[40] for x in sol.u] plot(sol.t, x1) plot!(sol.t, x20) plot!(sol.t, x40)</p><h1 id="-8"><a class="docs-heading-anchor" href="#-8">-</a><a class="docs-heading-anchor-permalink" href="#-8" title="Permalink"></a></h1><h1 id="run-the-data-generation-1"><a class="docs-heading-anchor" href="#run-the-data-generation-1">run the data generation</a><a class="docs-heading-anchor-permalink" href="#run-the-data-generation-1" title="Permalink"></a></h1><p>xt, yo, catalog = generate_data(ssm, u0);</p><h1 id="###-PLOT-STATE,-OBSERVATIONS-AND-CATALOG-1"><a class="docs-heading-anchor" href="####-PLOT-STATE,-OBSERVATIONS-AND-CATALOG-1">### PLOT STATE, OBSERVATIONS AND CATALOG</a><a class="docs-heading-anchor-permalink" href="####-PLOT-STATE,-OBSERVATIONS-AND-CATALOG-1" title="Permalink"></a></h1><p>plot(xt.t,  vcat(xt.u&#39;...)[:,1], line=(:solid,:red), label=&quot;x1&quot;) scatter!(yo.t, vcat(yo.u&#39;...)[:,1], markersize=2) plot!(xt.t, vcat(xt.u&#39;...)[:,20],line=(:solid,:blue), label=&quot;x20&quot;) scatter!(yo.t, vcat(yo.u&#39;...)[:,20],markersize=2) plot!(xt.t, vcat(xt.u&#39;...)[:,40],line=(:solid,:green), label=&quot;x40&quot;) scatter!(yo.t, vcat(yo.u&#39;...)[:,40],markersize=2) xlabel!(&quot;Lorenz-96 times&quot;) title!(&quot;Lorenz-96 true (continuous lines) and observed trajectories (dots)&quot;)</p><h1 id="###-MODEL-DATA-ASSIMILATION-(with-the-global-analogs)-1"><a class="docs-heading-anchor" href="####-MODEL-DATA-ASSIMILATION-(with-the-global-analogs)-1">### MODEL DATA ASSIMILATION (with the global analogs)</a><a class="docs-heading-anchor-permalink" href="####-MODEL-DATA-ASSIMILATION-(with-the-global-analogs)-1" title="Permalink"></a></h1><p>data<em>assimilation = DataAssimilation( ssm, xt ) @time x̂</em>classical<em>global  = data</em>assimilation(yo, EnKS(500));</p><p>RMSE(xt, x̂<em>classical</em>global)</p><p>local<em>analog</em>matrix =  BitArray{2}(diagm( -2  =&gt; trues(xt.nv-2),              -1  =&gt; trues(xt.nv-1),               0  =&gt; trues(xt.nv),               1  =&gt; trues(xt.nv-1),               2  =&gt; trues(xt.nv-2),                           J-2 =&gt; trues(xt.nv-(J-2)),              J-1 =&gt; trues(xt.nv-(J-1)))     + transpose(diagm( J-2 =&gt; trues(xt.nv-(J-2)),              J-1 =&gt; trues(xt.nv-(J-1))))     );</p><h1 id="-9"><a class="docs-heading-anchor" href="#-9">-</a><a class="docs-heading-anchor-permalink" href="#-9" title="Permalink"></a></h1><p>heatmap(local<em>analog</em>matrix) </p><h1 id="To-define-the-local-or-global-analog-forecasting,-we-generate-1"><a class="docs-heading-anchor" href="#To-define-the-local-or-global-analog-forecasting,-we-generate-1">To define the local or global analog forecasting, we generate</a><a class="docs-heading-anchor-permalink" href="#To-define-the-local-or-global-analog-forecasting,-we-generate-1" title="Permalink"></a></h1><h1 id="different-matrices-that-will-be-use-as-the-&quot;AF.neighborhood&quot;-argument.-1"><a class="docs-heading-anchor" href="#different-matrices-that-will-be-use-as-the-&quot;AF.neighborhood&quot;-argument.-1">different matrices that will be use as the &quot;AF.neighborhood&quot; argument.</a><a class="docs-heading-anchor-permalink" href="#different-matrices-that-will-be-use-as-the-&quot;AF.neighborhood&quot;-argument.-1" title="Permalink"></a></h1><h1 id="For-each-variable-of-the-system,-we-use-0-or-1-to-indicate-the-1"><a class="docs-heading-anchor" href="#For-each-variable-of-the-system,-we-use-0-or-1-to-indicate-the-1">For each variable of the system, we use 0 or 1 to indicate the</a><a class="docs-heading-anchor-permalink" href="#For-each-variable-of-the-system,-we-use-0-or-1-to-indicate-the-1" title="Permalink"></a></h1><h1 id="absence-or-presence-of-other-variables-in-the-analog-forecasting-1"><a class="docs-heading-anchor" href="#absence-or-presence-of-other-variables-in-the-analog-forecasting-1">absence or presence of other variables in the analog forecasting</a><a class="docs-heading-anchor-permalink" href="#absence-or-presence-of-other-variables-in-the-analog-forecasting-1" title="Permalink"></a></h1><h1 id="procedure.-For-instance,-in-the-local-analog-matrix-defined-above,-1"><a class="docs-heading-anchor" href="#procedure.-For-instance,-in-the-local-analog-matrix-defined-above,-1">procedure. For instance, in the local analog matrix defined above,</a><a class="docs-heading-anchor-permalink" href="#procedure.-For-instance,-in-the-local-analog-matrix-defined-above,-1" title="Permalink"></a></h1><h1 id="to-predict-the-variable-x_2-at-time-tdt,-we-will-use-the-local-1"><a class="docs-heading-anchor" href="#to-predict-the-variable-x_2-at-time-tdt,-we-will-use-the-local-1">to predict the variable <span>$x_2$</span> at time t+dt, we will use the local</a><a class="docs-heading-anchor-permalink" href="#to-predict-the-variable-x_2-at-time-tdt,-we-will-use-the-local-1" title="Permalink"></a></h1><h1 id="variables-x_1,-x_2,-x_3,-x_4-and-x_{40}-at-time-t.-#-1"><a class="docs-heading-anchor" href="#variables-x_1,-x_2,-x_3,-x_4-and-x_{40}-at-time-t.-#-1">variables <span>$x_1$</span>, <span>$x_2$</span>, <span>$x_3$</span>, <span>$x_4$</span> and <span>$x_{40}$</span> at time t.  # -</a><a class="docs-heading-anchor-permalink" href="#variables-x_1,-x_2,-x_3,-x_4-and-x_{40}-at-time-t.-#-1" title="Permalink"></a></h1><h1 id="###-ANALOG-DATA-ASSIMILATION-(with-the-global-analogs)-1"><a class="docs-heading-anchor" href="####-ANALOG-DATA-ASSIMILATION-(with-the-global-analogs)-1">### ANALOG DATA ASSIMILATION (with the global analogs)</a><a class="docs-heading-anchor-permalink" href="####-ANALOG-DATA-ASSIMILATION-(with-the-global-analogs)-1" title="Permalink"></a></h1><p>f  = AnalogForecasting( 100, xt, catalog,      regression = :local_linear, sampling = :gaussian)</p><p>data<em>assimilation = DataAssimilation( f, xt, ssm.sigma2</em>obs )</p><p>@time x̂<em>analog</em>global  = data<em>assimilation(yo, EnKS(500)) RMSE(xt, x̂</em>analog_global)</p><h1 id="###-ANALOG-DATA-ASSIMILATION-(with-the-local-analogs)-1"><a class="docs-heading-anchor" href="####-ANALOG-DATA-ASSIMILATION-(with-the-local-analogs)-1">### ANALOG DATA ASSIMILATION (with the local analogs)</a><a class="docs-heading-anchor-permalink" href="####-ANALOG-DATA-ASSIMILATION-(with-the-local-analogs)-1" title="Permalink"></a></h1><p>neighborhood = local<em>analog</em>matrix regression = :local<em>linear sampling   = :gaussian f  = AnalogForecasting( 100, xt, catalog, neighborhood, regression, sampling) data</em>assimilation = DataAssimilation( f, xt, ssm.sigma2<em>obs ) @time x̂</em>analog<em>local  = data</em>assimilation(yo, EnKS(500)) RMSE(xt, x̂<em>analog</em>local)</p><h1 id="###-COMPARISON-BETWEEN-GLOBAL-AND-LOCAL-ANALOG-DATA-ASSIMILATION-1"><a class="docs-heading-anchor" href="####-COMPARISON-BETWEEN-GLOBAL-AND-LOCAL-ANALOG-DATA-ASSIMILATION-1">### COMPARISON BETWEEN GLOBAL AND LOCAL ANALOG DATA ASSIMILATION</a><a class="docs-heading-anchor-permalink" href="####-COMPARISON-BETWEEN-GLOBAL-AND-LOCAL-ANALOG-DATA-ASSIMILATION-1" title="Permalink"></a></h1><p>import PyPlot fig = PyPlot.figure(figsize=(10,10))</p><h1 id="plot-1"><a class="docs-heading-anchor" href="#plot-1">plot</a><a class="docs-heading-anchor-permalink" href="#plot-1" title="Permalink"></a></h1><p>PyPlot.subplot(221) PyPlot.pcolormesh(hcat(xt.u...)) PyPlot.ylabel(&quot;Lorenz-96 times&quot;) PyPlot.title(&quot;True trajectories&quot;) PyPlot.subplot(222) PyPlot.pcolormesh(isnan.(hcat(yo.u...))) PyPlot.ylabel(&quot;Lorenz-96 times&quot;) PyPlot.title(&quot;Observed trajectories&quot;) PyPlot.subplot(223) PyPlot.pcolormesh(hcat(x̂<em>analog</em>global.u...)) PyPlot.ylabel(&quot;Lorenz-96 times&quot;) PyPlot.title(&quot;Global analog data assimilation&quot;) PyPlot.subplot(224) PyPlot.pcolormesh(hcat(x̂<em>analog</em>local.u...)) PyPlot.ylabel(&quot;Lorenz-96 times&quot;) PyPlot.title(&quot;Local analog data assimilation&quot;)</p><h1 id="#-error-1"><a class="docs-heading-anchor" href="##-error-1"># error</a><a class="docs-heading-anchor-permalink" href="##-error-1" title="Permalink"></a></h1><p>println(&quot;RMSE(global analog DA) = RMSE(xt, x̂_analog_global)&quot;) println(&quot;RMSE(local analog DA)  = RMSE(xt, x̂_analog_local)&quot;)</p><h1 id="The-results-show-that-the-global-analog-strategy-do-not-reach-1"><a class="docs-heading-anchor" href="#The-results-show-that-the-global-analog-strategy-do-not-reach-1">The results show that the global analog strategy do not reach</a><a class="docs-heading-anchor-permalink" href="#The-results-show-that-the-global-analog-strategy-do-not-reach-1" title="Permalink"></a></h1><h1 id="satisfying-results.-Indeed,-it-is-difficult-to-find-relevant-nearest-1"><a class="docs-heading-anchor" href="#satisfying-results.-Indeed,-it-is-difficult-to-find-relevant-nearest-1">satisfying results. Indeed, it is difficult to find relevant nearest</a><a class="docs-heading-anchor-permalink" href="#satisfying-results.-Indeed,-it-is-difficult-to-find-relevant-nearest-1" title="Permalink"></a></h1><h1 id="neighboors-on-40-dimensional-vectors.-The-only-way-to-improve-the-1"><a class="docs-heading-anchor" href="#neighboors-on-40-dimensional-vectors.-The-only-way-to-improve-the-1">neighboors on 40-dimensional vectors. The only way to improve the</a><a class="docs-heading-anchor-permalink" href="#neighboors-on-40-dimensional-vectors.-The-only-way-to-improve-the-1" title="Permalink"></a></h1><h1 id="results-in-such-a-global-strategy-is-to-deeply-increase-the-size-1"><a class="docs-heading-anchor" href="#results-in-such-a-global-strategy-is-to-deeply-increase-the-size-1">results in such a global strategy is to deeply increase the size</a><a class="docs-heading-anchor-permalink" href="#results-in-such-a-global-strategy-is-to-deeply-increase-the-size-1" title="Permalink"></a></h1><h1 id="of-the-catalog.-At-the-contrary,-in-the-local-analog-data-assimilation,-1"><a class="docs-heading-anchor" href="#of-the-catalog.-At-the-contrary,-in-the-local-analog-data-assimilation,-1">of the catalog. At the contrary, in the local analog data assimilation,</a><a class="docs-heading-anchor-permalink" href="#of-the-catalog.-At-the-contrary,-in-the-local-analog-data-assimilation,-1" title="Permalink"></a></h1><h1 id="we-are-able-to-track-correctly-the-true-trajectories,-even-with-a-1"><a class="docs-heading-anchor" href="#we-are-able-to-track-correctly-the-true-trajectories,-even-with-a-1">we are able to track correctly the true trajectories, even with a</a><a class="docs-heading-anchor-permalink" href="#we-are-able-to-track-correctly-the-true-trajectories,-even-with-a-1" title="Permalink"></a></h1><h1 id="short-catalog.-1"><a class="docs-heading-anchor" href="#short-catalog.-1">short catalog.</a><a class="docs-heading-anchor-permalink" href="#short-catalog.-1" title="Permalink"></a></h1><h1 id="#-Remark-1"><a class="docs-heading-anchor" href="##-Remark-1"># Remark</a><a class="docs-heading-anchor-permalink" href="##-Remark-1" title="Permalink"></a></h1><h1 id="-10"><a class="docs-heading-anchor" href="#-10"></a><a class="docs-heading-anchor-permalink" href="#-10" title="Permalink"></a></h1><h1 id="Note-that-for-all-the-previous-experiments,-we-use-the-robust-1"><a class="docs-heading-anchor" href="#Note-that-for-all-the-previous-experiments,-we-use-the-robust-1">Note that for all the previous experiments, we use the robust</a><a class="docs-heading-anchor-permalink" href="#Note-that-for-all-the-previous-experiments,-we-use-the-robust-1" title="Permalink"></a></h1><h1 id="Ensemble-Kalman-Smoother-(EnKS)-with-the-increment-or-local-linear-1"><a class="docs-heading-anchor" href="#Ensemble-Kalman-Smoother-(EnKS)-with-the-increment-or-local-linear-1">Ensemble Kalman Smoother (EnKS) with the increment or local linear</a><a class="docs-heading-anchor-permalink" href="#Ensemble-Kalman-Smoother-(EnKS)-with-the-increment-or-local-linear-1" title="Permalink"></a></h1><h1 id="regressions-and-the-Gaussian-sampling.-If-you-want-to-have-realistic-1"><a class="docs-heading-anchor" href="#regressions-and-the-Gaussian-sampling.-If-you-want-to-have-realistic-1">regressions and the Gaussian sampling. If you want to have realistic</a><a class="docs-heading-anchor-permalink" href="#regressions-and-the-Gaussian-sampling.-If-you-want-to-have-realistic-1" title="Permalink"></a></h1><h1 id="state-estimations,-we-preconize-the-use-of-the-Particle-Filter-1"><a class="docs-heading-anchor" href="#state-estimations,-we-preconize-the-use-of-the-Particle-Filter-1">state estimations, we preconize the use of the Particle Filter</a><a class="docs-heading-anchor-permalink" href="#state-estimations,-we-preconize-the-use-of-the-Particle-Filter-1" title="Permalink"></a></h1><h1 id="(DA.method-&#39;PF&#39;)-with-the-locally-constant-regression-(AF.regression-1"><a class="docs-heading-anchor" href="#(DA.method-&#39;PF&#39;)-with-the-locally-constant-regression-(AF.regression-1">(DA.method = &#39;PF&#39;) with the locally constant regression (AF.regression</a><a class="docs-heading-anchor-permalink" href="#(DA.method-&#39;PF&#39;)-with-the-locally-constant-regression-(AF.regression-1" title="Permalink"></a></h1><h1 id="&#39;locally_constant&#39;)-and-the-multinomial-sampler-(AF.sampling-1"><a class="docs-heading-anchor" href="#&#39;locally_constant&#39;)-and-the-multinomial-sampler-(AF.sampling-1">= &#39;locally_constant&#39;) and the multinomial sampler (AF.sampling =</a><a class="docs-heading-anchor-permalink" href="#&#39;locally_constant&#39;)-and-the-multinomial-sampler-(AF.sampling-1" title="Permalink"></a></h1><h1 id="&#39;multinomial&#39;)-with-a-large-number-of-particles-(DA.N).-For-more-1"><a class="docs-heading-anchor" href="#&#39;multinomial&#39;)-with-a-large-number-of-particles-(DA.N).-For-more-1">&#39;multinomial&#39;) with a large number of particles (DA.N). For more</a><a class="docs-heading-anchor-permalink" href="#&#39;multinomial&#39;)-with-a-large-number-of-particles-(DA.N).-For-more-1" title="Permalink"></a></h1><h1 id="details-about-the-different-options,-see-the-attached-publication:-1"><a class="docs-heading-anchor" href="#details-about-the-different-options,-see-the-attached-publication:-1">details about the different options, see the attached publication:</a><a class="docs-heading-anchor-permalink" href="#details-about-the-different-options,-see-the-attached-publication:-1" title="Permalink"></a></h1><h1 id="Lguensat,-R.,-Tandeo,-P.,-Ailliot,-P.,-Pulido,-M.,-and-Fablet,-R.-1"><a class="docs-heading-anchor" href="#Lguensat,-R.,-Tandeo,-P.,-Ailliot,-P.,-Pulido,-M.,-and-Fablet,-R.-1">Lguensat, R., Tandeo, P., Ailliot, P., Pulido, M., &amp; Fablet, R.</a><a class="docs-heading-anchor-permalink" href="#Lguensat,-R.,-Tandeo,-P.,-Ailliot,-P.,-Pulido,-M.,-and-Fablet,-R.-1" title="Permalink"></a></h1><h1 id="(2017).-The-Analog-Data-Assimilation.-*Monthly-Weather-Review*,-1"><a class="docs-heading-anchor" href="#(2017).-The-Analog-Data-Assimilation.-*Monthly-Weather-Review*,-1">(2017). The Analog Data Assimilation. <em>Monthly Weather Review</em>,</a><a class="docs-heading-anchor-permalink" href="#(2017).-The-Analog-Data-Assimilation.-*Monthly-Weather-Review*,-1" title="Permalink"></a></h1><h1 id="(10),-4093-4107.-#-1"><a class="docs-heading-anchor" href="#(10),-4093-4107.-#-1">145(10), 4093-4107.  # -</a><a class="docs-heading-anchor-permalink" href="#(10),-4093-4107.-#-1" title="Permalink"></a></h1></article></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 25 November 2019 10:25">Monday 25 November 2019</span>. Using Julia version 1.3.0-rc5.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
